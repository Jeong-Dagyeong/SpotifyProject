"use strict";(self.webpackChunkspotify_demo=self.webpackChunkspotify_demo||[]).push([[245],{2229:(e,t,r)=>{r.d(t,{A:()=>o});var a=r(1083),n=r(5800);const i=a.A.create({baseURL:n.$7,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}});i.interceptors.request.use((e=>(e.headers.Authorization="Bearer ".concat(localStorage.getItem("access_token")),e)));const o=i},5245:(e,t,r)=>{r.r(t),r.d(t,{default:()=>O});var a=r(6739),n=r(6858),i=r(9494),o=r(5647),s=r(5147),l=r(2764),c=r(680),d=r(431),p=r(4872),h=r(7665),u=r(7097),g=r(8511),x=r(7286),y=r(2229);const m=async()=>{try{return(await y.A.get("/me")).data}catch(e){throw new Error("fail to fetch user porfile")}},f=()=>{const e=localStorage.getItem("access_token");return(0,x.I)({queryKey:["current-user-profile"],queryFn:m,enabled:!!e})};var v=r(9783),j=r(5800);const A=async()=>{const e=crypto.getRandomValues(new Uint8Array(64)).reduce(((e,t)=>e+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[t%62]),""),t=(r=await(async e=>{const t=(new TextEncoder).encode(e);return window.crypto.subtle.digest("SHA-256",t)})(e),btoa(String.fromCharCode(...new Uint8Array(r))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"));var r;const a=v.U6,n=j._q,i=v.iW,o=new URL("https://accounts.spotify.com/authorize");if(window.localStorage.setItem("code_verifier",e),a&&n){const e={response_type:"code",client_id:a,scope:i,code_challenge_method:"S256",code_challenge:t,redirect_uri:n};o.search=new URLSearchParams(Object.entries(e)).toString(),window.location.href=o.toString()}};var w=r(4848);const b=(0,a.Ay)("div")((e=>{let{theme:t}=e;return{display:"flex",justifyContent:"space-evenly",marginTop:"30px"}})),k=()=>{const{mutate:e}=(()=>{const{data:e}=f(),t=(0,h.jE)();return(0,u.n)({mutationFn:t=>e?(0,g.Nt)((null==e?void 0:e.id)||"",t):Promise.reject(new Error("user is not definded")),onSuccess:()=>{t.invalidateQueries({queryKey:["current-user-playlists"]}),console.log("성공")}})})();return(0,w.jsx)("div",{children:(0,w.jsxs)(b,{children:[(0,w.jsx)(c.A,{}),(0,w.jsx)(i.A,{variant:"h2",fontWeight:700,children:"Your Library"}),(0,w.jsx)(d.A,{onClick:()=>{localStorage.getItem("access_token")||A(),e({name:"나의 플레이리스트"})},children:(0,w.jsx)(p.A,{sx:{color:"green"}})})]})})};var C=r(4422),S=r(4529),_=r(6475);var I=r(6540),P=r(5692);const R=()=>{const e=(0,a.Ay)("div")((e=>{let{theme:t}=e;return{heigth:"100vh"}})),t=(0,a.Ay)("div")((e=>{let{theme:t}=e;return{width:"80%",height:"150px",backgroundColor:t.palette.background.paper,borderRadius:"10px",padding:"20px",margin:"0 auto",marginTop:"10px"}})),r=(0,a.Ay)(d.A)((e=>{let{theme:t}=e;return{width:"120px",height:"30px",borderRadius:"30px",backgroundColor:t.palette.text.primary,color:t.palette.background.default,textAlign:"center",marginTop:"20px"}}));return(0,w.jsx)("div",{children:(0,w.jsx)(e,{children:(0,w.jsxs)(t,{children:[(0,w.jsx)(i.A,{variant:"h2",fontWeight:700,children:"Create your first playlist"}),(0,w.jsx)(i.A,{variant:"body1",children:"It's easy, we'll help you"}),(0,w.jsx)(r,{children:(0,w.jsx)(i.A,{variant:"body1",fontWeight:700,children:"Create playlist"})})]})})})},E=(0,a.Ay)("div")((e=>{let{theme:t}=e;return{overflowY:"auto",maxHeight:"calc(100vh - 240px)",height:"100%",padding:"12px","&::-webkit-scrollbar":{display:"none"},msOverflowStyle:"none",scrollbarWidth:"none",[t.breakpoints.down("sm")]:{maxHeight:"calc(100vh - 65px - 119px)"}}})),U=(0,a.Ay)(C.A)((e=>{let{theme:t}=e;return{"&:hover":{backgroundColor:t.palette.action.hover}}})),W=()=>{const{data:e,fetchNextPage:t,hasNextPage:r,isFetchingNextPage:a}=(e=>{let{limit:t,offset:r}=e;return(0,_.q)({queryKey:["current-user-playlists"],queryFn:e=>{let{pageParam:r=0}=e;return(0,g.U4)({limit:t,offset:r})},initialPageParam:0,getNextPageParam:e=>{if(e.next){const t=new URL(e.next).searchParams.get("offset");return t?parseInt(t):void 0}}})})({limit:10,offset:0}),{data:n}=f(),{ref:s,inView:l}=(0,P.Wx)();(0,I.useEffect)((()=>{l&&r&&!a&&t()}),[l,r,a]);const c=(0,o.Zp)();return n&&e?(0,w.jsx)(E,{children:n.id?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(S.A,{cols:2,gap:16,variant:"standard",children:e.pages.map(((e,t)=>e.items.map(((e,r)=>{const a=Array.isArray(e.images)&&e.images.length>0?e.images[0].url:"",n=e.id;return n?(0,w.jsxs)(U,{onClick:()=>(e=>{c("/playlist/".concat(e))})(n),children:[(0,w.jsx)("img",{src:a||"/images/noImage.png",alt:e.name,loading:"lazy",style:{borderRadius:8}}),(0,w.jsx)(i.A,{variant:"subtitle1",fontWeight:700,color:"limegreen",mt:1,children:e.name}),(0,w.jsxs)(i.A,{variant:"body2",color:"#aaa",children:["Playlist • ",e.owner.display_name]})]},"".concat(t,"-").concat(e.id)):null}))))}),(0,w.jsx)("div",{ref:s})]}):(0,w.jsx)(R,{})}):null};var q=r(8344);const z=()=>(0,w.jsx)(d.A,{variant:"contained",color:"secondary",size:"large",onClick:()=>{A()},children:"Login"}),L=(0,a.Ay)(n.A)((e=>{let{theme:t}=e;return{position:"relative",display:"inline-block"}})),N=(0,a.Ay)(n.A)((e=>{let{theme:t}=e;return{position:"absolute",top:"42px",right:-25,backgroundColor:t.palette.background.paper,boxShadow:t.shadows[2],padding:t.spacing(1),borderRadius:t.shape.borderRadius,zIndex:10}})),F=()=>{var e;const[t,r]=(0,I.useState)(!1),[a,i]=(0,I.useState)(!1),{data:s}=f(),l=null==s||null===(e=s.images)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.url,c=((0,o.Zp)(),(0,h.jE)());return(0,w.jsx)(n.A,{display:"flex",justifyContent:"flex-end",alignItems:"center",height:"40px",position:"relative",children:s?(0,w.jsxs)(L,{children:[(0,w.jsx)(q.A,{src:!t&&l?l:"/broken-image.jpg",onError:()=>r(!0),alt:"user-profile",sx:{width:32,height:32,cursor:"pointer"},onClick:()=>{i((e=>!e))}}),a&&(0,w.jsx)(N,{children:(0,w.jsx)(d.A,{variant:"text",color:"inherit",size:"small",onClick:()=>{localStorage.removeItem("access_token"),c.clear(),window.location.reload()},children:"Logout"})})]}):(0,w.jsx)(z,{})})},T=(0,a.Ay)("div")({display:"flex",height:"100vh",padding:"8px"}),H=(0,a.Ay)("div")((e=>{let{theme:t}=e;return{width:"331px",height:"100%",display:"flex",flexDirection:"column",[t.breakpoints.down("sm")]:{display:"none"}}})),B=(0,a.Ay)(n.A)((e=>{let{theme:t}=e;return{borderRadius:"8px",backgroundColor:t.palette.background.paper,color:t.palette.text.primary,width:"100%",padding:"20px",marginBottom:"8px",marginRight:"8px"}})),D=(0,a.Ay)("ul")({listStyle:"none",padding:0,margin:0}),K=(0,a.Ay)(o.k2)((e=>{let{theme:t}=e;return{textDecoration:"none",display:"flex",alignItems:"center",gap:"20px",color:t.palette.text.secondary,"&.active":{color:t.palette.text.primary},"& svg":{color:t.palette.text.secondary},"&.active svg":{color:t.palette.text.primary}}})),O=()=>(0,w.jsx)("div",{children:(0,w.jsxs)(T,{children:[(0,w.jsxs)(H,{children:[(0,w.jsx)(B,{children:(0,w.jsxs)(D,{children:[(0,w.jsxs)(K,{to:"/",children:[(0,w.jsx)(s.A,{}),(0,w.jsx)(i.A,{variant:"h2",fontWeight:700,children:"Home"})]}),(0,w.jsxs)(K,{to:"/search",children:[(0,w.jsx)(l.A,{}),(0,w.jsx)(i.A,{variant:"h2",fontWeight:700,children:"Search"})]})]})}),(0,w.jsx)(k,{}),(0,w.jsx)(W,{})]}),(0,w.jsxs)(B,{children:[(0,w.jsx)(F,{}),(0,w.jsx)(o.sv,{})]})]})})},8511:(e,t,r)=>{r.d(t,{Dg:()=>o,Nt:()=>s,U4:()=>n,bt:()=>i});var a=r(2229);const n=async e=>{let{limit:t,offset:r}=e;try{return(await a.A.get("/me/playlists",{params:{limit:t,offset:r}})).data}catch(e){throw new Error("fila to fetch current user playlists")}},i=async e=>{try{return(await a.A.get("/playlists/".concat(e.playlist_id),{params:e})).data}catch(e){throw new Error("fail to fetch playlist detail")}},o=async e=>{try{return(await a.A.get("/playlists/".concat(e.playlist_id,"/tracks"),{params:e})).data}catch(e){throw new Error("fail to fetch playlist items")}},s=async(e,t)=>{try{const{name:r,playlist_public:n,collaborative:i,description:o}=t;return(await a.A.post("/users/".concat(e,"/playlists"),{name:r,public:n,collaborative:i,description:o})).data}catch(e){throw new Error("fail to fetch create playlist")}}}}]);
//# sourceMappingURL=245.js.map?ver=c7ef7d3f15e0c6fc8b85