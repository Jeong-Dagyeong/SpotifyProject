"use strict";(self.webpackChunkspotify_demo=self.webpackChunkspotify_demo||[]).push([[269],{269:(e,t,r)=>{r.r(t),r.d(t,{default:()=>z});var n=r(6540),a=r(5647),i=r(7286),l=r(8511);var o=r(6739),s=r(9494),c=r(4026),d=r(6700),p=r(8828),h=r(4963),u=r(1361),y=r(3923),x=r(6475);const m=e=>{let{playlist_id:t,limit:r}=e;return(0,x.q)({queryKey:["playlist-items",t],queryFn:e=>{let{pageParam:n=0}=e;return(0,l.Dg)({playlist_id:t,limit:r,offset:n})},initialPageParam:0,getNextPageParam:e=>{if(e.next){const t=new URL(e.next).searchParams.get("offset");return t?parseInt(t):void 0}}})};var g=r(5692),v=r(4848);const f=(0,o.Ay)(h.A)((()=>({borderBottom:"none"}))),j=(0,o.Ay)(p.A)((e=>{let{theme:t}=e;return{"&:hover":{backgroundColor:t.palette.action.hover}}})),A=e=>{var t;let{item:r,index:a,playlist_id:i}=e;const{data:l,fetchNextPage:o,hasNextPage:s,isFetchingNextPage:c}=m({playlist_id:i,limit:10});console.log("ddd",l);const{ref:d,inView:p}=(0,g.Wx)();(0,n.useEffect)((()=>{p&&s&&!c&&o()}),[p,s,c]);let h=new Date,u=h.getFullYear(),y=String(h.getMonth()+1).padStart(2,"0"),x=String(h.getDate()).padStart(2,"0"),A=String(h.getMinutes()),w=String(h.getSeconds()),b="".concat(u,"-").concat(y,"-").concat(x),k="".concat(A,":").concat(w);return(0,v.jsxs)(j,{children:[(0,v.jsx)(f,{children:a}),(0,v.jsx)(f,{children:r.track.name||"no name"}),(0,v.jsx)(f,{children:(P=r.track,"description"in P?"N/A":null===(t=r.track.album)||void 0===t?void 0:t.name)}),(0,v.jsx)(f,{children:b||"Unknown"}),(0,v.jsxs)(f,{children:[k||"Unknown",(0,v.jsx)("span",{ref:d,style:{display:"inline-block",width:1,height:1}})]})]});var P};var w=r(5800),b=r(6858),k=r(568),P=r(8634),_=r(4705),S=r(1083),O=r(424);function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}let E=function(e){return e.Track="track",e.Album="album",e.Playlsit="playlist",e.Show="show",e.Episode="episode",e.AudioBook="audiobook",e.Atrist="artist",e}({});const N=(0,o.Ay)(p.A)((e=>{let{theme:t}=e;return{"&:hover":{backgroundColor:t.palette.action.hover}}})),B=(0,o.Ay)(h.A)((()=>({borderBottom:"none"}))),I=(0,o.Ay)("img")({borderRadius:"4px",marginRight:"12px"}),L=(0,o.Ay)("div")((()=>({overflowY:"auto",maxHeight:"calc(100vh - 300px - 100px)",width:"100%","&::-webkit-scrollbar":{display:"none"},msOverflowStyle:"none",scrollbarWidth:"none"}))),W=e=>{let{list:t}=e;const{ref:r,inView:n}=(0,g.Wx)();return(0,v.jsx)(L,{style:{marginTop:"40px"},children:(0,v.jsx)(c.A,{children:(0,v.jsx)(u.A,{children:t.map(((e,t)=>{var n,a,i;return(0,v.jsxs)(N,{children:[(0,v.jsx)(B,{children:t+1}),(0,v.jsxs)(B,{children:[(0,v.jsx)(I,{src:(null===(n=e.album)||void 0===n||null===(n=n.images[0])||void 0===n?void 0:n.url)||"/images/noImage.png",width:"40px"}),e.name]}),(0,v.jsx)(B,{children:null===(a=e.album)||void 0===a?void 0:a.name}),(0,v.jsx)(B,{children:(null===(i=e.artists)||void 0===i||null===(i=i[0])||void 0===i?void 0:i.name)||"Unknown Artist"}),(0,v.jsx)(B,{children:(0,v.jsx)("span",{ref:r,style:{display:"inline-block",width:1,height:1}})})]},e.id||t)}))})})})};var C=r(2764);const F=()=>{var e,t;const r=(0,o.Ay)(b.A)({display:"flex",flexDirection:"column",gap:"40px",marginTop:"40px"}),[a,i]=(0,n.useState)("");console.log("keyword",a);const{data:l,error:c,isLoading:d}=(e=>{const t=(0,O.A)();return(0,x.q)({queryKey:["search",e],queryFn:r=>{let{pageParam:n=0}=r;if(!t)throw new Error("no token available");return(async(e,t)=>{try{const r=new URLSearchParams;return r.append("q",t.q),r.append("type",t.type.join(",")),t.market&&r.append("market",t.market),t.limit&&r.append("limit",t.limit.toString()),t.offset&&r.append("offset",t.offset.toString()),t.include_external&&r.append("include_external",t.include_external),(await S.A.get("".concat(w.$7,"/search?").concat(r.toString()),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})).data}catch(e){throw new Error("fail to search by keyword")}})(t,D(D({},e),{},{offset:n}))},initialPageParam:0,getNextPageParam:e=>{var t,r,n,a,i,l,o;const s=(null===(t=e.tracks)||void 0===t?void 0:t.next)||(null===(r=e.artists)||void 0===r?void 0:r.next)||(null===(n=e.albums)||void 0===n?void 0:n.next)||(null===(a=e.playlists)||void 0===a?void 0:a.next)||(null===(i=e.shows)||void 0===i?void 0:i.next)||(null===(l=e.episode)||void 0===l?void 0:l.next)||(null===(o=e.audiobooks)||void 0===o?void 0:o.next);if(s){const e=new URL(s).searchParams.get("offset");return e?parseInt(e):void 0}},enabled:!!e.q})})({q:a,type:[E.Track]});console.log("ddd",l);const p=null!==(e=null==l||null===(t=l.pages[0])||void 0===t||null===(t=t.tracks)||void 0===t?void 0:t.items)&&void 0!==e?e:[],h=p.length>0;return(0,v.jsxs)("div",{children:[(0,v.jsx)(s.A,{variant:"h1",my:"10px",marginBottom:"20px",children:"Let's find something for your playlist"}),(0,v.jsx)(k.A,{value:a,onChange:e=>{i(e.target.value)},placeholder:"Search...",slotProps:{input:{startAdornment:(0,v.jsx)(P.A,{position:"start",children:(0,v.jsx)(C.A,{style:{color:"white"}})})}},style:{width:"100%"}}),d?(0,v.jsx)(y.A,{}):h?(0,v.jsx)(W,{list:p}):""===a?(0,v.jsx)(v.Fragment,{}):(0,v.jsx)(r,{children:(0,v.jsx)(s.A,{variant:"h1",gutterBottom:!0,children:'검색결과 : "'.concat(a,'"는 존재하지 않습니다.')})})]})},U=(0,o.Ay)("div")((e=>{let{theme:t}=e;return{width:"100%",padding:"16px 16px 0px 16px",display:"flex",flexDirection:"column",alignItems:"center",gap:"16px"}})),R=(0,o.Ay)("div")((e=>{let{theme:t}=e;return{display:"flex",flexDirection:"column",marginLeft:"20px"}})),T=(0,o.Ay)("div")((()=>({overflowY:"auto",maxHeight:"calc(100vh - 300px - 100px)",width:"100%","&::-webkit-scrollbar":{display:"none"},msOverflowStyle:"none",scrollbarWidth:"none"}))),z=()=>{var e,t,r,n;const{id:o}=(0,a.g)(),{data:x,isLoading:g}=(S={playlist_id:o||""},(0,i.I)({queryKey:["playlist-detail",S.playlist_id],queryFn:()=>(0,l.bt)(S),enabled:Boolean(null==S?void 0:S.playlist_id)})),{data:f,isLoading:j,error:b,fetchNextPage:k,hasNextPage:P,isFetchingNextPage:_}=m({playlist_id:o||"",limit:10});var S;if(!o)return(0,v.jsx)(a.C5,{to:"/"});if(g||!x)return(0,v.jsx)(y.A,{});const O=(null===(e=x.images)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.url)||"";return(0,v.jsxs)(U,{children:[(0,v.jsx)("img",{src:O||"/images/noImage.png",alt:x.name,loading:"lazy",style:{borderRadius:8,width:100,height:100}}),(0,v.jsxs)(R,{children:[(0,v.jsx)(s.A,{variant:"h3",fontWeight:700,color:"white",children:x.name}),(0,v.jsx)(s.A,{variant:"h2",fontWeight:700,color:"theme.primary",children:x.owner.display_name}),(0,v.jsxs)(s.A,{variant:"h2",fontWeight:700,color:"theme.primary",children:[null!==(t=null==x||null===(r=x.tracks)||void 0===r?void 0:r.total)&&void 0!==t?t:0," songs"]})]}),0===(null==x||null===(n=x.tracks)||void 0===n?void 0:n.total)?(0,v.jsx)(F,{}):(0,v.jsx)(T,{children:(0,v.jsxs)(c.A,{children:[(0,v.jsx)(d.A,{children:(0,v.jsxs)(p.A,{children:[(0,v.jsx)(h.A,{children:"#"}),(0,v.jsx)(h.A,{children:"Title"}),(0,v.jsx)(h.A,{children:"Album"}),(0,v.jsx)(h.A,{children:"Date Added"}),(0,v.jsx)(h.A,{children:"Duration"})]})}),(0,v.jsx)(u.A,{children:null==f?void 0:f.pages.map(((e,t)=>e.items.map(((e,r)=>(0,v.jsx)(A,{item:e,index:t*w.Wt+r+1,playlist_id:o},t*w.Wt+r+1)))))})]})})]})}},424:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(7286),a=r(4871);const i=()=>{const{data:e}=(0,n.I)({queryKey:["client-credential=token"],queryFn:a.M});return null==e?void 0:e.access_token}},2229:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(1083),a=r(5800);const i=n.A.create({baseURL:a.$7,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}});i.interceptors.request.use((e=>(e.headers.Authorization="Bearer ".concat(localStorage.getItem("access_token")),e)));const l=i},8511:(e,t,r)=>{r.d(t,{Dg:()=>l,Nt:()=>o,U4:()=>a,bt:()=>i});var n=r(2229);const a=async e=>{let{limit:t,offset:r}=e;try{return(await n.A.get("/me/playlists",{params:{limit:t,offset:r}})).data}catch(e){throw new Error("fila to fetch current user playlists")}},i=async e=>{try{return(await n.A.get("/playlists/".concat(e.playlist_id),{params:e})).data}catch(e){throw new Error("fail to fetch playlist detail")}},l=async e=>{try{return(await n.A.get("/playlists/".concat(e.playlist_id,"/tracks"),{params:e})).data}catch(e){throw new Error("fail to fetch playlist items")}},o=async(e,t)=>{try{const{name:r,playlist_public:a,collaborative:i,description:l}=t;return(await n.A.post("/users/".concat(e,"/playlists"),{name:r,public:a,collaborative:i,description:l})).data}catch(e){throw new Error("fail to fetch create playlist")}}}}]);
//# sourceMappingURL=269.js.map?ver=25bdbe5450ad1547ca5c